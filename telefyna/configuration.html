<!DOCTYPE html>
<html>
    <head>
        <link rel="icon" type="image/png" href="favicon.ico">

        <link rel="stylesheet" href="res/bootstrap.min.css">
        <script src="res/jquery.min.js"></script>
        <script src="res/bootstrap.min.js"></script>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        
        <script src="res/angular.min.js"></script>
        <script src="res/angular-cookies.js"></script>

        <script src="res/bootstrap-datepicker.js"></script>
        <link rel="stylesheet" href="res/datepicker.css">
        <link rel="stylesheet" href="res/timepicker.css">
        <script src="res/timepicker.js"></script>
        
        <link rel="stylesheet" href="res/telefyna.css">
        <script src="telefyna.js"></script>
    </head>

    <body ng-app="Telefyna" ng-controller="Config" center-block>
        <div >
            <h1>|Configuring|</h1>
            <img src="telefyna.png" alt="Telefyna Icon" width="150" height="150">
            
            <!-- Other configurations before playlists-->
            <div class="section">
                <label class="checkbox-inline">Last Modified: <b>{{config.lastModified}}</b></label>
                <div class="section action">
                    Name
                    <input type="text" class="form-control flex-wrap" ng-model="config.name" ng-change="modify()">
                </div>
                <div class="section action">
                    Version
                    <input type="text" class="form-control flex-wrap" ng-model="config.version" ng-change="modify()">
                </div>
                <div class="form-check form-switch">
                    <label class="checkbox-inline"><input type="checkbox" ng-model="config.automationDisabled" ng-change="modify()"> Disable Automation</label>
                </div>
                <div class="form-check form-switch">
                    <label class="checkbox-inline"><input type="checkbox" ng-model="config.notificationsDisabled" ng-change="modify()"> Disable Notifications</label>
                </div>
            </div>
            <div class="section">
                <div class="action">
                    <!-- Create -->
                    <button type="button" class="btn btn-info" data-toggle="modal" data-target="#add">Create Playlist</button>
                    <div class="modal fade action-content" id="add" role="dialog">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                          <form class="modal-content" ng-submit="add()">
                            <div class="modal-header">
                              <h5 class="modal-title">Create a new Playlist</h5>
                              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                              </button>
                            </div>
                            <div class="modal-body">
                                <div class="alert alert-danger section action" role="alert" ng-show="error">
                                    {{error}}
                                </div>
                                <div class="section action">
                                    <label class="checkbox-inline"><input type="checkbox" ng-model="playlist.active"> Active</label>
                                </div>
                                <div class="section action">
                                    * Name *
                                    <input type="text" class="form-control" required ng-model="playlist.name">
                                </div>
                                <div class="section action">
                                    Description
                                    <input type="text" class="form-control" ng-model="playlist.description">
                                </div>
                                <div class="section action">
                                    Type
                                    <select class="form-control multiselect-ui" ng-model="playlist.type">
                                        <option value="ONLINE">Online Stream</option>
                                        <option value="LOCAL_SEQUENCED">Local sequenced folder</option>
                                        <option value="LOCAL_RANDOMIZED">Local random folder</option>
                                        <option value="LOCAL_RESUMING">Local resuming folder</option>
                                        <option value="LOCAL_RESUMING_SAME">Local same resuming folder</option>
                                        <option value="LOCAL_RESUMING_NEXT">Local next resuming folder</option>
                                    </select>
                                </div>
                                <div class="section action">
                                    * Stream URL Or Local folder name *
                                    <input type="text" class="form-control" required ng-model="playlist.urlOrFolder">
                                </div>
                                <div class="section action">
                                    Special Bumper folder name
                                    <input type="text" class="form-control" ng-model="playlist.specialBumperFolder">
                                </div>
                                <div class="section action">
                                    Weekly Day(s)
                                    <select class="form-control multiselect-ui" multiple ng-model="playlist.days">
                                        <option value="1">Sunday</option>
                                        <option value="2">Monday</option>
                                        <option value="3">Tuesday</option>
                                        <option value="4">Wednesday</option>
                                        <option value="5">Thursday</option>
                                        <option value="6">Friday</option>
                                        <option value="7">Saturady</option>
                                    </select>
                                </div>
                                <div class="section action">
                                    Future Date(s)
                                    <input type="text" class="form-control date" ng-model="datePickerValue" ng-change="setPlaylistDate()">
                                </div>
                                <div class="section action">
                                    Start Time
                                    <input type="text" class="form-control timepicker" ng-model="playlist.start">
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-info" ng-click="clear()">Clear</button>
                                <button type="button" class="btn btn-danger" id="close-add" data-dismiss="modal">Cancel</button>
                                <button type="submit" class="btn btn-success">Add</button>
                            </div>
                        </form>
                        </div>
                      </div>

                    <!-- Edit -->
                    <button type="button" class="btn btn-info" data-toggle="modal" data-target="#edit" ng-disabled="config.playlists.length == 0">Edit Playlist</button>
                    <div class="modal fade action-content" id="edit" role="dialog">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                          <form class="modal-content" ng-submit="revise()">
                            <div class="modal-header">
                              <h5 class="modal-title">Edit an existing Playlist</h5>
                              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                              </button>
                            </div>
                            <div class="modal-body">
                                <div class="alert alert-danger section action" role="alert" ng-show="error">
                                    {{error}}
                                </div>
                                <div class="section action">
                                    * Select Non Copied Playlist to edit *
                                    <select class="form-control" required ng-model="edit" ng-change="renderEdit()">
                                        <option ng-repeat="p in config.playlists" ng-if="isNotClone(p)" value="{{$index}}">{{name($index)}}</option>
                                    </select>
                                </div>
                                <div class="section action">
                                    <label class="checkbox-inline"><input type="checkbox" ng-model="playlist.active"> Active</label>
                                </div>
                                <div class="section action">
                                    * Name *
                                    <input type="text" class="form-control" required ng-model="playlist.name">
                                </div>
                                <div class="section action">
                                    Description
                                    <input type="text" class="form-control" ng-model="playlist.description">
                                </div>
                                <div class="section action">
                                    Type
                                    <select class="form-control multiselect-ui" ng-model="playlist.type">
                                        <option value="ONLINE">Online Stream</option>
                                        <option value="LOCAL_SEQUENCED">Local sequenced folder</option>
                                        <option value="LOCAL_RANDOMIZED">Local random folder</option>
                                        <option value="LOCAL_RESUMING">Local resuming folder</option>
                                        <option value="LOCAL_RESUMING_SAME">Local same resuming folder</option>
                                        <option value="LOCAL_RESUMING_NEXT">Local next resuming folder</option>
                                    </select>
                                </div>
                                <div class="section action">
                                    * Stream URL Or Local folder name *
                                    <input type="text" class="form-control" required ng-model="playlist.urlOrFolder">
                                </div>
                                <div class="section action">
                                    Weekly Day(s)
                                    <select class="form-control multiselect-ui" multiple ng-model="playlist.days">
                                        <option value="1">Sunday</option>
                                        <option value="2">Monday</option>
                                        <option value="3">Tuesday</option>
                                        <option value="4">Wednesday</option>
                                        <option value="5">Thursday</option>
                                        <option value="6">Friday</option>
                                        <option value="7">Saturady</option>
                                    </select>
                                </div>
                                <div class="section action">
                                    Future Date(s)
                                    <input type="text" class="form-control date" ng-model="datePickerValue" ng-change="setPlaylistDate()">
                                </div>
                                <div class="section action">
                                    Start Time
                                    <input type="text" class="form-control timepicker" ng-model="playlist.start">
                                </div>
                                <div class="section action">
                                    <label class="checkbox-inline"><input type="checkbox" ng-model="playlist.playingGeneralBumpers"> Playing General Bumpers</label>
                                </div>
                                <div class="section action">
                                    Special Bumper folder name
                                    <input type="text" class="form-control" ng-model="playlist.specialBumperFolder">
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-info" ng-click="clear()">Clear</button>
                                <button type="button" class="btn btn-danger" id="close-edit" data-dismiss="modal">Cancel</button>
                                <button type="submit" class="btn btn-success">Save</button>
                            </div>
                        </form>
                        </div>
                      </div>

                    <!-- Copy -->
                    <button type="button" class="btn btn-info" data-toggle="modal" data-target="#clone" ng-disabled="config.playlists.length == 0">Copy Playlist</button>
                    <div class="modal fade action-content" id="clone" role="dialog">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                          <form class="modal-content" ng-submit="clone()">
                            <div class="modal-header">
                              <h5 class="modal-title">Copy an existing Playlist</h5>
                              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                              </button>
                            </div>
                            <div class="modal-body">
                                <div class="section action">
                                    * Select Parent Non Copied Playlist *
                                    <select class="form-control" required ng-model="playlist.clone">
                                        <option ng-repeat="p in config.playlists" ng-if="isNotClone(p)" value="{{$index}}">{{name($index)}}</option>
                                    </select>
                                </div>
                                <div class="section action">
                                    Weekly Day(s)
                                    <select class="form-control multiselect-ui" multiple ng-model="playlist.days">
                                        <option value="1">Sunday</option>
                                        <option value="2">Monday</option>
                                        <option value="3">Tuesday</option>
                                        <option value="4">Wednesday</option>
                                        <option value="5">Thursday</option>
                                        <option value="6">Friday</option>
                                        <option value="7">Saturady</option>
                                    </select>
                                </div>
                                <div class="section action">
                                    Future Date(s)
                                    <input type="text" class="form-control date" ng-model="datePickerValue" ng-change="setPlaylistDate()">
                                </div>
                                <div class="section action">
                                    * Start Time *
                                    <input type="text" class="form-control timepicker" required ng-model="playlist.start">
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-info" ng-click="clear()">Clear</button>
                                <button type="button" class="btn btn-danger" id="close-clone" data-dismiss="modal">Cancel</button>
                                <button type="submit" class="btn btn-success">Clone</button>
                            </div>
                        </form>
                        </div>
                      </div>
                </div>

                <!-- Delete -->
                <div class="action">
                    <button type="button" class="btn btn-danger" data-toggle="modal" data-target="#delete" ng-disabled="config.playlists.length == 0">Delete Playlist(s)</button>
                    <div class="modal fade action-content" id="delete" role="dialog">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                            <form class="modal-content" ng-submit="delete()">
                            <div class="modal-header">
                              <h5 class="modal-title">Delete Exisiting Playlist(s) And their respective Copies</h5>
                              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                              </button>
                            </div>
                            <div class="modal-body">
                                <div class="section action">
                                    Select Playlists(s)
                                    <select id="playlists-delete" class="form-control multiselect-ui" multiple ng-model="deletable">
                                        <option ng-repeat="p in config.playlists" value="{{$index}}">{{name($index)}}</option>
                                    </select>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-info" ng-click="deletable = []">Clear</button>
                                <button type="button" class="btn btn-danger" id="close-delete" data-dismiss="modal">Cancel</button>
                                <button type="submit" class="btn btn-danger" ng-disabled="deletable.length == 0">Delete Selected</button>
                            </div>
                          </form>
                        </div>
                    </div>
                </div>

                <!-- Import/Export -->
                <div class="action">
                    <button type="file" class="btn btn-info" onclick="jQuery('#import-config').click()">Import</button>
                    <input type="file" hidden id="import-config" ng-model="configFile" onchange="angular.element(this).scope().importConfig(event)">
                    <button type="button" class="btn btn-success" ng-disabled="config.playlists.length == 0" ng-click="exportConfig()">Export</button>
                </div>
            </div>

            <!-- Results -->
            <div class="section config-result">
                <pre>{{config | json: 2}}</pre>
            </div>
            <a id="export" hidden></a>
            <div id="footer">
                apps@avventohome.org
                <br>
                <label>Copyright © 2021</label>
            </div>
          </div>
    </body>
</html>
